<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Peterson Technology Partners</title>
<link rel="stylesheet" href="css/bootstrap.css" >

<script src="js/jquery-2.1.0.min.js"></script>
<script src="js/jquery.form-validator.min.js"></script>
<script src="js/tab.js"></script>
<script src="js/bootstrap.js"></script>
<script src="js/modal.js"></script>
<script src="js/jquery.cookies.js"></script>
<script>

$(document).ready(function(){
	if($.cookie("email")==null){
		window.location = "/EmployeeWeb/login.html";
	}
	$.validate({
		validateOnBlur : false, // disable validation when input looses focus
    	errorMessagePosition : 'top', // Instead of 'element' which is default
   		scrollToTopOnError : true // Set this property to true if you have a long form
		
	});
	$("#tabs").tab();
	var obj;
	$.post("http://localhost:8080/EmployeeWeb/Console",function(data){		
		var jObj = eval("(" + data + ")");	
		group = jObj[1];
		
		//Set the Cookie:
		//$.cookie("email",jObj[0].email);
		
		$("#name").html(jObj[0].fname + " " + jObj[0].lname);
		$("#lname").html(jObj[0].lname);
		$("#add1").html(jObj[0].street);
		$("#add2").html(jObj[0].city + ", " + jObj[0].state + " " + jObj[0].zip);
		$("#email").html(jObj[0].email);
		$("#role").html(jObj[0].role);
		$("#login-info").hide();

			for(var i=0; i<group.length; i++){
				$("#curGroupM").append("<div class='col-md-3'><div class='panel panel-default text-center'><h4>" + group[i].name + "</h4></div></div>");
			}
		if(jObj[0].role == "DEVELOPER"){
			$("#CreateGroupHeading").html("Join Group");
			$("#GroupButton").html("Join");
			$("#doGroup").attr("action","JoinGroupServlet");
		}
		
	});	
	function logout(){
		
		$.ajax({
			type: "POST",
			url: "EmployeeWeb/Logout"
		});
	}
	$("#logoutButton").click(function(){
		$.removeCookie("email");
		window.location = "/EmployeeWeb/login.html";
	});
});

</script>

</head>

<body>

<div class="container">
	<div class="row">
	<div class="alert alert-info text-center" id="login-info">Logging in. Please wait...</div>
	</div>
    <div class="row">    
        <div class="col-md-3">
            <div class="panel panel-primary">
                <div class="panel-heading">Employee</div>
                <div class="panel-body">
                 
				 <div id="name"></div>
				 <div id="add1"></div>
				 <div id="add2"></div>
				 <div id="email"></div>
				 <div id="role"></div>
				 
				 <button type="button" class="btn btn-default" id="logoutButton">Logout</button>
				         
                
                </div>
            </div>
        </div>
        <div class="col-md-9">
            <ul class="nav nav-tabs" id="tabs" data-tabs="tabs">            
                <li class="active"><a href="#home" data-toggle="tab">Home</a></li>
                <li><a href="#groups" data-toggle="tab">Groups</a></li>
                <li><a href="#timesheet" data-toggle="tab">Timesheets</a></li>
            </ul>
            <div class="tab-content">
            	<div class="tab-pane active" id="home">
					<div class="jumbotron"> No new updates</div>
				</div>
            	<div class="tab-pane" id="groups">
            		<div class="panel panel-default">
            		<div class="panel-heading" id="CreateGroupHeading">Create Group</div>
	            		<div class="panel-body">
							<form class="form-inline" action="CreateGroupServlet" method="post" id="doGroup">
							  <div class="form-group">
							    <label class="sr-only" for="groupCname">Group name</label>
							    <input class="form-control" id="groupCname" name="groupCname" placeholder="Group name">
							  </div>
							  
							  
							  <button type="submit" class="btn btn-default" id="GroupButton">Create</button>
							</form>
						</div>
					<div class="panel-heading">Current Groups</div>
						<div class="panel-body" id="curGroupPanel">
							<div class="row"  id="curGroupM">
							
							</div>
						</div>
					</div>
				</div>
                <div class="tab-pane" id="timesheet">Timesheets</div>
            </div>
            </div>
        </div>
    </div>
</div>
</body>
</html>